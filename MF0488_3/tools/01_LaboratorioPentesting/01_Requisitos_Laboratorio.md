# Requisitos del laboratorio de pruebas

Para crear un laboratorio virtual en el que practicar y mejorar tus habilidades en pruebas de penetración y evaluación de vulnerabilidades vas a necesitar:

- Un **hipervisor de tipo 2**: VirtualBox, WMWare,…
- Suficiente capacidad hardware - memoria, espacio de almacenamiento, procesador, conexión a Internet,…- para destinar a tus máquinas virtuales.
  - Asegúrate de que tu dispositivo anfitrión dispone de capacidades de virtualización.



**Componentes del laboratorio**

| Máquina atacante | Servidor web vulnerable |
| :--------------: | :---------------------: |
|    Pentester     |         Victima         |
|    Kali Linux    |   BeeBox Linux Server   |
| 192.168,204.128  |     192.168,204.130     |



## Creando el laboratorio de pruebas de penetración y evaluación de vulnerabilidades

### 1. Descargar e instalar VirtualBox

Para descargar e instalar VirtualBox, sigue estos pasos:

#### Paso 1: Descargar VirtualBox

1. **Ir al sitio web de VirtualBox:**
   - Abre tu navegador web y dirígete a [la página de descargas de VirtualBox](https://www.virtualbox.org/wiki/Downloads).

2. **Seleccionar el instalador adecuado:**
   - En la sección "VirtualBox platform packages", selecciona el instalador correspondiente a tu sistema operativo:
     - **Windows:** `Windows hosts`
     - **macOS:** `OS X hosts`
     - **Linux:** Selecciona la distribución de Linux que estés utilizando.

#### Paso 2: Instalar VirtualBox

##### En Windows

1. **Ejecutar el instalador:**
   - Abre el archivo descargado (`VirtualBox-x.x.x-xxxxx-Win.exe`).

2. **Asistente de instalación:**
   - Sigue las instrucciones del asistente de instalación.
   - Selecciona las opciones predeterminadas a menos que necesites personalizar la instalación.

3. **Instalación de drivers:**
   - Durante la instalación, es posible que se te pida instalar drivers de red y USB. Acepta las solicitudes para instalar estos componentes necesarios.

4. **Finalizar la instalación:**
   - Una vez completada la instalación, haz clic en `Finish` para cerrar el asistente.

##### En macOS

1. **Ejecutar el instalador:**
   - Abre el archivo descargado (`VirtualBox-x.x.x-xxxxx-OSX.dmg`).

2. **Montar el instalador:**
   - Haz doble clic en el icono del instalador de VirtualBox en la ventana que se abre.

3. **Asistente de instalación:**
   - Sigue las instrucciones del asistente de instalación.
   - Puede que necesites introducir tu contraseña de administrador para completar la instalación.

4. **Permisos del sistema:**
   - Si el sistema bloquea la instalación de extensiones del kernel, ve a `Preferencias del Sistema > Seguridad y Privacidad` y permite las extensiones del desarrollador Oracle.

5. **Finalizar la instalación:**
   - Una vez completada la instalación, cierra el instalador.

##### En Linux

1. **Abrir una terminal:**
   - Abre una terminal en tu distribución de Linux.

2. **Agregar el repositorio de VirtualBox:**
   - Para Ubuntu/Debian, ejecuta:
     ```bash
     sudo apt update
     sudo apt install -y virtualbox
     ```

3. **Instalar VirtualBox:**
   - Para Fedora/RHEL/CentOS, puedes usar `dnf` o `yum`:
     ```bash
     sudo dnf install -y virtualbox
     ```

4. **Instalar dependencias adicionales:**
   - Es posible que necesites instalar dependencias adicionales para soporte de USB y otros dispositivos:
     ```bash
     sudo apt install -y dkms build-essential
     ```

5. **Iniciar VirtualBox:**
   - Una vez completada la instalación, puedes iniciar VirtualBox desde el menú de aplicaciones o ejecutando `virtualbox` en la terminal.

#### Paso 3: Instalar Extensiones Adicionales (Opcional)

1. **Descargar el paquete de extensiones:**
   - En la misma página de descargas de VirtualBox, bajo la sección "[VirtualBox Extension Pack](https://download.virtualbox.org/virtualbox/7.0.20/Oracle_VM_VirtualBox_Extension_Pack-7.0.20.vbox-extpack)", descarga el paquete correspondiente a tu versión de VirtualBox.

2. **Instalar el paquete de extensiones:**
   - Abre VirtualBox.
   
   - Ve a `Archivo > Preferencias > Extensiones`.
   
   - Haz clic en el icono de `+` y selecciona el archivo de extensión descargado.
   
   - Sigue las instrucciones para completar la instalación del paquete de extensiones.
   
     

Siguiendo estos pasos, tendrás VirtualBox instalado y listo para crear y gestionar máquinas virtuales en tu sistema.

### 2. Máquina atacante

Instalar [Kali Linux](https://www.kali.org/get-kali/#kali-platforms) en una máquina virtual en VirtualBox puede hacerse de dos maneras: utilizando un archivo OVA o un archivo ISO. A continuación se detallan ambos métodos:

#### Método 1: Usar un archivo OVA

1. **Descargar el archivo OVA de Kali Linux:**
   - Ve a la [página de descargas de imágenes de máquinas virtuales de Kali Linux](https://www.kali.org/get-kali/#kali-virtual-machines).
   - [Descarga el archivo OVA de VirtualBox](https://cdimage.kali.org/kali-2024.2/kali-linux-2024.2-virtualbox-amd64.7z).

2. **Importar el archivo OVA en VirtualBox:**
   - Abre VirtualBox.
   - Ve a `Archivo > Importar servicio virtualizado`.
   - Haz clic en `Elegir un archivo` y selecciona el archivo OVA que descargaste.
   - Haz clic en `Siguiente` y luego en `Importar` para comenzar la importación.

3. **Iniciar la máquina virtual:**
   - Una vez importada, la nueva máquina virtual aparecerá en la lista de VirtualBox.
   - Selecciona la máquina virtual y haz clic en `Iniciar`.

#### Método 2: Usar un archivo ISO

1. **Descargar el archivo ISO de Kali Linux:**
   - Ve a la [página de descargas de Kali Linux](https://www.kali.org/get-kali/#kali-platforms).
   - Descarga la imagen ISO para instalación.

2. **Crear una nueva máquina virtual en VirtualBox:**
   - Abre VirtualBox.
   - Haz clic en `Nueva` para crear una nueva máquina virtual.
   - Configura los detalles de la máquina virtual:
     - Nombre: `Kali Linux`
     - Tipo: `Linux`
     - Versión: `Debian (64-bit)` (o `Debian (32-bit)` si descargaste la versión de 32 bits)
   - Asigna la memoria RAM (al menos 2 GB recomendados).
   - Crea un disco duro virtual (al menos 20 GB recomendados).

3. **Configurar la máquina virtual:**
   - Selecciona la máquina virtual creada y haz clic en `Configuración`.
   - En la sección `Almacenamiento`, selecciona `Vacío` bajo `Controlador IDE`.
   - Haz clic en el icono de disco a la derecha y selecciona `Elegir un archivo de disco...`.
   - Navega hasta el archivo ISO de Kali Linux que descargaste y selecciónalo.

4. **Iniciar la máquina virtual:**
   - Selecciona la máquina virtual y haz clic en `Iniciar`.
   - La máquina virtual arrancará desde el archivo ISO de Kali Linux.

5. **Instalar Kali Linux:**
   - Sigue las instrucciones en pantalla para instalar Kali Linux en la máquina virtual.
   - Selecciona `Graphical install` para una instalación más amigable.
   - Configura el idioma, la región y el teclado según tus preferencias.
   - Configura el nombre del host, el dominio y crea una cuenta de usuario.
   - Particiona el disco (puedes elegir las opciones predeterminadas si no estás seguro).
   - Completa la instalación y reinicia la máquina virtual cuando se te pida.

6. **Retirar el medio de instalación:**
   - Después de reiniciar, asegúrate de retirar el archivo ISO del almacenamiento virtual:
     - Ve a `Configuración > Almacenamiento`.
     - Selecciona el archivo ISO bajo `Controlador IDE` y haz clic en el icono de disco a la derecha.
     - Selecciona `Eliminar disco de la unidad virtual`.

Siguiendo estos pasos, tendrás Kali Linux instalado y funcionando en una máquina virtual en VirtualBox, ya sea utilizando un archivo OVA para una configuración rápida o un archivo ISO para una instalación más personalizada.

#### Configuración de la máquina virtual atacante

Revisa la configuración de tu máquina virtual atacante:

- RAM entre 3 a 4
- Disco duro: 50GB
- 2 Procesadores

### 3. Máquina vulnerable

#### Máquina vulnerable 01

Para instalar Metasploitable2, que es una máquina virtual diseñada para pruebas de penetración y seguridad, sigue estos pasos:

##### 1. **Descargar Metasploitable2**

1. **Ve al sitio de Rapid7**: Metasploitable2 está disponible para descarga en el sitio de Rapid7, la empresa detrás de Metasploit. Visita [la página de Metasploitable en Rapid7](https://www.rapid7.com/db/modules/auxiliary/server/capture/http_ntlm) y busca el enlace de descarga para Metasploitable2.
   
2. **Descarga el archivo**: Generalmente, el archivo será un archivo comprimido `.zip` o `.7z` que contiene una imagen de máquina virtual.

##### 2. **Preparar el Entorno de Virtualización**

Para ejecutar Metasploitable2, necesitarás una aplicación de virtualización como VirtualBox o VMware.

###### **Para VirtualBox:**

1. **Descargar e instalar VirtualBox**: Si aún no lo tienes, descarga VirtualBox desde [el sitio oficial de Oracle](https://www.virtualbox.org/).

2. **Descargar e instalar las Extensiones de VirtualBox**: Esto puede ser necesario para manejar ciertas funcionalidades adicionales. Puedes encontrarlas en la misma página de VirtualBox.

###### **Para VMware:**

1. **Descargar e instalar VMware Workstation Player**: Si prefieres VMware, descarga VMware Workstation Player desde [el sitio oficial de VMware](https://www.vmware.com/products/workstation-player.html).

##### 3. **Importar la Máquina Virtual**

1. **Extraer el archivo descargado**: Si el archivo descargado está comprimido, descomprímelo usando una herramienta como 7-Zip o WinRAR. Dentro, encontrarás un archivo `.vmdk` (para VMware) o un archivo `.ova` (para VirtualBox).

2. **Importar a VirtualBox**:
   - Abre VirtualBox.
   - Ve a "Archivo" > "Importar aplicación virtual" y selecciona el archivo `.ova` que extrajiste.
   - Sigue las instrucciones en pantalla para completar la importación.

3. **Importar a VMware**:
   - Abre VMware Workstation Player.
   - Ve a "Archivo" > "Abrir" y selecciona el archivo `.vmx` (si tienes uno) o usa la opción de importar para añadir la máquina virtual.
   

##### 4. **Configurar la Máquina Virtual**

1. **Asignar recursos**: Asegúrate de que la máquina virtual tenga suficiente RAM y CPU asignados. Un mínimo de 1GB de RAM debería ser suficiente para Metasploitable2.

2. **Configurar la red**: Configura la red de la máquina virtual en modo "Adaptador puente" o "NAT" dependiendo de cómo quieras que la máquina interactúe con tu red.

##### 5. **Iniciar y Configurar Metasploitable2**

1. **Inicia la máquina virtual**: Una vez importada, selecciona Metasploitable2 en la interfaz de tu software de virtualización y haz clic en "Iniciar".

2. **Acceder a la máquina**: Metasploitable2 debería arrancar y mostrarte la pantalla de inicio con información sobre el sistema y credenciales predeterminadas.

3. **Credenciales**: Los detalles de acceso predeterminados son generalmente:
   - **Usuario**: msfadmin
   - **Contraseña**: msfadmin

¡Y eso es todo! Ahora tienes Metasploitable2 corriendo en tu entorno de virtualización. Puedes usar esta máquina para practicar pruebas de penetración y explorar vulnerabilidades de forma segura en un entorno controlado.