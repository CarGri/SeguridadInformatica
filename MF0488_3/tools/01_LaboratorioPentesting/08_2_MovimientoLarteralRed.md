# Movimiento lateral en la red

El **movimiento lateral** en la red es una técnica utilizada por atacantes una vez que han comprometido un sistema dentro de una red. Su objetivo es explorar, identificar y acceder a otros sistemas o recursos dentro de la misma red para expandir su control y obtener acceso a información más valiosa o para avanzar hacia objetivos específicos.

### ¿Cómo Funciona el Movimiento Lateral?

1. **Acceso Inicial:**
   - El atacante compromete un sistema en la red, ya sea mediante phishing, explotación de vulnerabilidades, credenciales robadas, etc. Este sistema comprometido se convierte en su punto de entrada o "beachhead".

2. **Reconocimiento Interno:**
   - Una vez dentro, el atacante realiza un reconocimiento de la red interna para descubrir otros sistemas conectados, cuentas de usuario, servicios activos, y vulnerabilidades. Esta etapa incluye técnicas como:
     - **Enumeración de redes y recursos compartidos.**
     - **Escaneo de puertos y servicios en otros dispositivos.**
     - **Análisis de tráfico de red para identificar comunicaciones y activos críticos.**

3. **Credenciales y Escalamiento de Privilegios:**
   - El atacante intenta robar o reutilizar credenciales (como contraseñas o tokens de sesión) obtenidas del sistema comprometido. También puede intentar escalar privilegios en el sistema actual para obtener derechos administrativos que le permitan ejecutar comandos más amplios o acceder a más recursos.

4. **Explotación de Otros Sistemas:**
   - Utilizando la información y las credenciales obtenidas, el atacante intenta comprometer otros sistemas dentro de la red. Este proceso puede incluir:
     - **Conexión a shares SMB en otros sistemas.**
     - **Uso de herramientas de administración remota (como PowerShell, RDP, SSH) para acceder a otros servidores o estaciones de trabajo.**
     - **Instalación de malware o puertas traseras en otros sistemas.**

5. **Expansión y Persistencia:**
   - El atacante se mueve de un sistema a otro, expandiendo su control sobre la red. En cada sistema comprometido, puede instalar herramientas adicionales para mantener el acceso o para facilitar el movimiento lateral hacia otros sistemas.
   - En esta etapa, el atacante también puede plantar mecanismos de persistencia para asegurarse de que puede mantener el acceso incluso si algunos de sus vectores iniciales de ataque son descubiertos y cerrados.

### Objetivos del Movimiento Lateral

- **Acceso a Datos Sensibles:** Alcanzar servidores o bases de datos que contienen información valiosa, como datos financieros, propiedad intelectual, o información personal identificable (PII).
- **Compromiso de Cuentas de Alto Privilegio:** Obtener acceso a cuentas de administrador o de dominio que le permitan al atacante controlar toda la red.
- **Saltar Entre Segmentos de Red:** Si la red está segmentada (dividida en subredes con diferentes niveles de seguridad), el movimiento lateral busca cruzar estas barreras para comprometer otros segmentos de la red.
- **Preparar para un Ataque Final:** Como la instalación de ransomware, exfiltración masiva de datos, o destrucción de sistemas.

### Ejemplos de Técnicas de Movimiento Lateral

- **Pass-the-Hash:** Reutilizar hashes de contraseñas obtenidos de un sistema comprometido para autenticarse en otros sistemas sin necesidad de conocer la contraseña original.
- **Pass-the-Ticket:** Similar al pass-the-hash, pero utilizando tickets Kerberos en redes Windows para autenticarse en otros sistemas.
- **Explotación de Servicios de Administración Remota:** Uso de herramientas como PsExec, PowerShell Remoting, o WinRM para ejecutar comandos en otros sistemas de manera remota.
- **Acceso a Recursos Compartidos (SMB, NFS):** Utilizar recursos compartidos, como carpetas SMB o NFS, para obtener acceso a archivos y datos en otros sistemas.

### Defensa Contra Movimiento Lateral

- **Segmentación de Red:** Dividir la red en subredes separadas y aplicar políticas estrictas de control de acceso para limitar el movimiento lateral.
- **Monitorización de Actividad:** Implementar soluciones de detección de intrusiones (IDS/IPS) y SIEM para monitorizar y alertar sobre actividades sospechosas dentro de la red.
- **Control de Acceso Basado en Roles (RBAC):** Asegurarse de que los usuarios solo tengan acceso a los recursos que realmente necesitan, minimizando la cantidad de cuentas con privilegios elevados.
- **Multi-Factor Authentication (MFA):** Reducir el riesgo de que credenciales robadas sean utilizadas para moverse lateralmente dentro de la red.

En resumen, el movimiento lateral es una fase crítica en los ataques avanzados, permitiendo a los atacantes explorar y comprometer recursos adicionales dentro de una red, lo que hace que la detección y respuesta tempranas sean esenciales para evitar daños mayores.